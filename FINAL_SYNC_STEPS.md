# ãƒªãƒ¢ãƒ¼ãƒˆSupabaseã¸ã®æœ€çµ‚ãƒ‡ãƒ¼ã‚¿åŒæœŸæ‰‹é †

**é‡è¦**: ãƒ­ãƒ¼ã‚«ãƒ«ã®DockerSupabaseã¯çµ¶å¯¾ã«å‰Šé™¤ã—ã¾ã›ã‚“ã€‚ãƒªãƒ¢ãƒ¼ãƒˆSupabaseã®ã¿ã‚’æ“ä½œã—ã¾ã™ã€‚

---

## ğŸ“Š ç¾åœ¨ã®çŠ¶æ³

### å®Œäº†ã—ãŸä½œæ¥­
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ãƒ³ãƒ—: `@backups/local_data_full_20260115_131712.sql` (79MB)
- âœ… ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆ`DROP SCHEMA public CASCADE;`ï¼‰
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ãƒªãƒ¢ãƒ¼ãƒˆã«ãƒ—ãƒƒã‚·ãƒ¥

### æ®‹ã‚Šã®ä½œæ¥­
- ğŸ”„ ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªãƒ¢ãƒ¼ãƒˆã«ãƒªã‚¹ãƒˆã‚¢

---

## ğŸš€ æ¨å¥¨ã•ã‚Œã‚‹æœ€çµ‚æ‰‹é †

### æ–¹æ³•1: å°ã•ã„ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†å‰²ã—ã¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å®Ÿè¡Œï¼ˆæœ€ã‚‚ç¢ºå®Ÿï¼‰

#### ã‚¹ãƒ†ãƒƒãƒ—1: ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã¿ã‚’å…ˆã«ãƒªã‚¹ãƒˆã‚¢

æ—¢ã«ä½œæˆæ¸ˆã¿ã®ãƒ†ãƒ¼ãƒ–ãƒ«åˆ¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½¿ç”¨ï¼š

1. **users** (196KB)
   ```bash
   # ãƒ•ã‚¡ã‚¤ãƒ«: @backups/users_data.sql
   ```

2. **posts** (5.8MB)
   ```bash
   # ãƒ•ã‚¡ã‚¤ãƒ«: @backups/posts_data.sql
   ```

3. **comments** (13MB)
   ```bash
   # ãƒ•ã‚¡ã‚¤ãƒ«: @backups/comments_data.sql
   ```

#### ã‚¹ãƒ†ãƒƒãƒ—2: Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å®Ÿè¡Œ

1. https://supabase.com/dashboard/project/pazyejhciyfoklrhpfvt/sql ã«ã‚¢ã‚¯ã‚»ã‚¹

2. å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã—ã¦å®Ÿè¡Œï¼š
   - `@backups/users_data.sql` ã®å†…å®¹ã‚’å®Ÿè¡Œ
   - `@backups/posts_data.sql` ã®å†…å®¹ã‚’å®Ÿè¡Œ
   - `@backups/comments_data.sql` ã®å†…å®¹ã‚’å®Ÿè¡Œ

---

### æ–¹æ³•2: Supabase CLIã®db restoreã‚³ãƒãƒ³ãƒ‰ï¼ˆè©¦é¨“çš„ï¼‰

```bash
# ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®URLã‚’å–å¾—
REMOTE_URL=$(supabase projects list --format json | jq -r '.[] | select(.id=="pazyejhciyfoklrhpfvt") | .database_url')

# ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¹ãƒˆã‚¢
cat @backups/local_data_full_20260115_131712.sql | \
  supabase db execute --db-url "$REMOTE_URL"
```

---

### æ–¹æ³•3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å†è¨­å®šã—ã¦ç›´æ¥psql

#### ã‚¹ãƒ†ãƒƒãƒ—1: Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒªã‚»ãƒƒãƒˆ

1. https://supabase.com/dashboard/project/pazyejhciyfoklrhpfvt/settings/database ã«ã‚¢ã‚¯ã‚»ã‚¹
2. **Database password** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ **Reset database password** ã‚’ã‚¯ãƒªãƒƒã‚¯
3. æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼

#### ã‚¹ãƒ†ãƒƒãƒ—2: psqlã§ãƒªã‚¹ãƒˆã‚¢

```bash
# æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç’°å¢ƒå¤‰æ•°ã«è¨­å®š
export PGPASSWORD="æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"

# ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¹ãƒˆã‚¢
psql -h db.pazyejhciyfoklrhpfvt.supabase.co \
  -p 5432 \
  -U postgres \
  -d postgres \
  < @backups/local_data_full_20260115_131712.sql
```

---

## ğŸ“ æœ€ã‚‚ç°¡å˜ã§ç¢ºå®Ÿãªæ–¹æ³•

**æ–¹æ³•1: ãƒ†ãƒ¼ãƒ–ãƒ«åˆ¥ã«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å®Ÿè¡Œ**

ã“ã‚ŒãŒæœ€ã‚‚ç¢ºå®Ÿã§ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã«ãã„æ–¹æ³•ã§ã™ã€‚

### ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

1. **users_data.sqlã®å†…å®¹ã‚’è¡¨ç¤º**
   ```bash
   cat @backups/users_data.sql
   ```

2. **å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼**

3. **Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å®Ÿè¡Œ**
   - https://supabase.com/dashboard/project/pazyejhciyfoklrhpfvt/sql
   - ã‚³ãƒ”ãƒ¼ã—ãŸå†…å®¹ã‚’ãƒšãƒ¼ã‚¹ãƒˆã—ã¦å®Ÿè¡Œ

4. **posts_data.sqlã¨comments_data.sqlã‚‚åŒæ§˜ã«å®Ÿè¡Œ**

---

## âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …

### ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¿è­·
- âŒ **çµ¶å¯¾ã«ãƒ­ãƒ¼ã‚«ãƒ«ã®DockerSupabaseã‚’å‰Šé™¤ã—ãªã„**
- âŒ **`supabase db reset`ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã—ãªã„**
- âœ… **ãƒªãƒ¢ãƒ¼ãƒˆSupabaseã®ã¿ã‚’æ“ä½œã™ã‚‹**

### ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§
- ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®Ÿè¡Œé †åº: `users` â†’ `posts` â†’ `comments`
- å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ãŒã‚ã‚‹ãŸã‚ã€é †åºãŒé‡è¦

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã©ã®æ–¹æ³•ã‚’é¸æŠã—ã¾ã™ã‹ï¼Ÿ

1. **æ–¹æ³•1**: ãƒ†ãƒ¼ãƒ–ãƒ«åˆ¥ã«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
2. **æ–¹æ³•2**: Supabase CLIã§å®Ÿè¡Œï¼ˆè©¦é¨“çš„ï¼‰
3. **æ–¹æ³•3**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦psqlã§å®Ÿè¡Œ

æ¨å¥¨ã¯**æ–¹æ³•1**ã§ã™ã€‚ç¢ºå®Ÿã§ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã«ãã„ã§ã™ã€‚
