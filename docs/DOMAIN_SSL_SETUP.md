# ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆanke.jpï¼‰ã¨SSLå°å…¥ã‚¬ã‚¤ãƒ‰

VPSã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆ133.18.122.123ï¼‰ã‹ã‚‰ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆanke.jpï¼‰ã¸ã®ç§»è¡Œã¨ã€Let's Encrypt SSLã®å°å…¥æ‰‹é †

**âœ… è¨­å®šå®Œäº†æ—¥**: 2026å¹´1æœˆ16æ—¥  
**âœ… SSLè¨¼æ˜æ›¸æœ‰åŠ¹æœŸé™**: 2026å¹´4æœˆ16æ—¥ï¼ˆè‡ªå‹•æ›´æ–°è¨­å®šæ¸ˆã¿ï¼‰

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [å®Ÿæ–½ã—ãŸè¨­å®šå†…å®¹](#å®Ÿæ–½ã—ãŸè¨­å®šå†…å®¹)
3. [ã‚¹ãƒ†ãƒƒãƒ—1: DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã®è¨­å®š](#ã‚¹ãƒ†ãƒƒãƒ—1-dnsãƒ¬ã‚³ãƒ¼ãƒ‰ã®è¨­å®š)
4. [ã‚¹ãƒ†ãƒƒãƒ—2: Nginxè¨­å®šã®æ›´æ–°](#ã‚¹ãƒ†ãƒƒãƒ—2-nginxè¨­å®šã®æ›´æ–°)
5. [ã‚¹ãƒ†ãƒƒãƒ—3: SSLè¨¼æ˜æ›¸ã®å–å¾—](#ã‚¹ãƒ†ãƒƒãƒ—3-sslè¨¼æ˜æ›¸ã®å–å¾—)
6. [ã‚¹ãƒ†ãƒƒãƒ—4: ç’°å¢ƒå¤‰æ•°ã®æ›´æ–°](#ã‚¹ãƒ†ãƒƒãƒ—4-ç’°å¢ƒå¤‰æ•°ã®æ›´æ–°)
7. [ã‚¹ãƒ†ãƒƒãƒ—5: å‹•ä½œç¢ºèª](#ã‚¹ãƒ†ãƒƒãƒ—5-å‹•ä½œç¢ºèª)
8. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
9. [ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹](#ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹)

---

## æ¦‚è¦

### **å¤‰æ›´å‰ã®çŠ¶æ…‹**
- **URL**: http://133.18.122.123:3000
- **ãƒ—ãƒ­ãƒˆã‚³ãƒ«**: HTTPï¼ˆæš—å·åŒ–ãªã—ï¼‰
- **ãƒãƒ¼ãƒˆ**: 3000ï¼ˆç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼‰

### **å¤‰æ›´å¾Œã®çŠ¶æ…‹ï¼ˆç¾åœ¨ï¼‰**
- **URL**: https://anke.jp
- **ãƒ—ãƒ­ãƒˆã‚³ãƒ«**: HTTPSï¼ˆSSL/TLSæš—å·åŒ–ï¼‰
- **ãƒãƒ¼ãƒˆ**: 443ï¼ˆæ¨™æº–HTTPSï¼‰
- **ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**: HTTP â†’ HTTPSè‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
- **SSLè¨¼æ˜æ›¸**: Let's Encryptï¼ˆè‡ªå‹•æ›´æ–°è¨­å®šæ¸ˆã¿ï¼‰

---

## å®Ÿæ–½ã—ãŸè¨­å®šå†…å®¹

### å®Œäº†ã—ãŸä½œæ¥­

1. âœ… **DNSè¨­å®š**
   - `anke.jp` â†’ `133.18.122.123`
   - `www.anke.jp` â†’ `133.18.122.123`
   - TTL: 300ç§’ï¼ˆDNSå¤‰æ›´æ™‚ï¼‰â†’ 3600ç§’ï¼ˆé€šå¸¸é‹ç”¨ï¼‰

2. âœ… **Nginxè¨­å®š**
   - ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·è¨­å®šï¼ˆãƒãƒ¼ãƒˆ80 â†’ 3000ï¼‰
   - ãƒ‰ãƒ¡ã‚¤ãƒ³åå¯¾å¿œï¼ˆ`server_name anke.jp www.anke.jp`ï¼‰

3. âœ… **SSLè¨¼æ˜æ›¸**
   - Let's Encryptè¨¼æ˜æ›¸å–å¾—
   - HTTPSå¯¾å¿œï¼ˆãƒãƒ¼ãƒˆ443ï¼‰
   - HTTPâ†’HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   - è‡ªå‹•æ›´æ–°è¨­å®š

4. âœ… **ç’°å¢ƒå¤‰æ•°**
   - `NEXT_PUBLIC_APP_URL=https://anke.jp`

### æ‰€è¦æ™‚é–“
- DNSè¨­å®š: 5åˆ†
- Nginxè¨­å®š: 10åˆ†
- SSLè¨¼æ˜æ›¸å–å¾—: 5åˆ†
- DNSä¼æ’­å¾…ã¡: ç´„30åˆ†
- **åˆè¨ˆ**: ç´„50åˆ†

---

## å‰ææ¡ä»¶

### **å¿…è¦ãªã‚‚ã®**
- âœ… VPSï¼ˆ133.18.122.123ï¼‰
- âœ… Nginxï¼ˆã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿: nginx/1.24.0ï¼‰
- âœ… ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆanke.jpï¼‰
- âœ… ãƒ‰ãƒ¡ã‚¤ãƒ³ã®DNSç®¡ç†æ¨©é™
- âœ… SSHæ¥ç¶šï¼ˆubuntu@133.18.122.123ï¼‰

### **ç¢ºèªäº‹é …**
```bash
# Nginxã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
nginx -v
# å‡ºåŠ›: nginx version: nginx/1.24.0 (Ubuntu)

# Nginxã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
systemctl status nginx

# Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¢ºèª
pm2 status
```

---

## ç¾åœ¨ã®æ§‹æˆ

### **ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ**
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼
  â†“
  http://133.18.122.123:3000
  â†“
  Next.js (PM2ã§èµ·å‹•ã€ãƒãƒ¼ãƒˆ3000)
  â†“
  Supabase (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)
```

### **Nginxç¾åœ¨ã®è¨­å®š**
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: `/etc/nginx/sites-available/default`
- **çŠ¶æ…‹**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šï¼ˆãƒãƒ¼ãƒˆ80ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ï¼‰
- **Next.jsã¨ã®é€£æº**: ãªã—ï¼ˆç›´æ¥ãƒãƒ¼ãƒˆ3000ã«ã‚¢ã‚¯ã‚»ã‚¹ï¼‰

---

## å°å…¥è¨ˆç”»

### **å…¨ä½“ã®æµã‚Œ**

```
ã€ãƒ•ã‚§ãƒ¼ã‚º1: DNSè¨­å®šã€‘
1. ç¾åœ¨ã®DNSè¨­å®šã‚’ç¢ºèªï¼ˆ133.18.234.69ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼‰
2. DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆanke.jp: 133.18.234.69 â†’ 133.18.122.123ï¼‰
3. DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆwww.anke.jp: 133.18.234.69 â†’ 133.18.122.123ï¼‰
4. SPFãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡ã™ã‚‹å ´åˆï¼‰
5. DNSä¼æ’­ã‚’å¾…ã¤ï¼ˆTTL 3600ç§’ã€é€šå¸¸1ã€œ2æ™‚é–“ï¼‰
6. DNSä¼æ’­ã‚’ç¢ºèªï¼ˆdig/nslookup/ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ï¼‰

ã€ãƒ•ã‚§ãƒ¼ã‚º2: Nginxè¨­å®šã€‘
3. anke.jpç”¨ã®Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
4. ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚’è¨­å®šï¼ˆNginx â†’ Next.js:3000ï¼‰
5. Nginxè¨­å®šã‚’ãƒ†ã‚¹ãƒˆï¼†ãƒªãƒ­ãƒ¼ãƒ‰

ã€ãƒ•ã‚§ãƒ¼ã‚º3: SSLå°å…¥ã€‘
6. Certbotï¼ˆLet's Encryptï¼‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
7. SSLè¨¼æ˜æ›¸ã‚’å–å¾—
8. HTTPSè¨­å®šã‚’è‡ªå‹•é©ç”¨
9. HTTP â†’ HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’è¨­å®š

ã€ãƒ•ã‚§ãƒ¼ã‚º4: è‡ªå‹•æ›´æ–°ã€‘
10. SSLè¨¼æ˜æ›¸ã®è‡ªå‹•æ›´æ–°ã‚’è¨­å®š
11. CRONã‚¸ãƒ§ãƒ–ã§å®šæœŸæ›´æ–°

ã€ãƒ•ã‚§ãƒ¼ã‚º5: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šã€‘
12. ç’°å¢ƒå¤‰æ•°ã‚’æ›´æ–°ï¼ˆNEXT_PUBLIC_APP_URLï¼‰
13. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†èµ·å‹•

ã€ãƒ•ã‚§ãƒ¼ã‚º6: å‹•ä½œç¢ºèªã€‘
14. HTTPSã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¢ºèª
15. HTTPãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’ç¢ºèª
16. SSLè¨¼æ˜æ›¸ã‚’ç¢ºèª
```

### **æ‰€è¦æ™‚é–“**
- **DNSè¨­å®š**: 5åˆ†
- **Nginxè¨­å®š**: 10åˆ†
- **SSLå°å…¥**: 10åˆ†
- **å‹•ä½œç¢ºèª**: 5åˆ†
- **åˆè¨ˆ**: ç´„30åˆ†ï¼ˆDNSä¼æ’­æ™‚é–“ã‚’é™¤ãï¼‰

---

## ã‚¹ãƒ†ãƒƒãƒ—1: DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã®è¨­å®š

### **1-1. ãŠåå‰.comã®DNSç®¡ç†ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹**

1. ãŠåå‰.com Naviã«ãƒ­ã‚°ã‚¤ãƒ³
2. ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ä¸€è¦§ã€â†’ã€Œanke.jpã€ã‚’é¸æŠ
3. ã€ŒDNSè¨­å®š/è»¢é€è¨­å®šã€â†’ã€ŒDNSãƒ¬ã‚³ãƒ¼ãƒ‰è¨­å®šã€

### **1-2. Aãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°**

ä»¥ä¸‹ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šï¼š

| ã‚¿ã‚¤ãƒ— | ãƒ›ã‚¹ãƒˆå | VALUE | TTL |
|--------|---------|-------|-----|
| A | anke.jp | 133.18.122.123 | 300 |
| A | www.anke.jp | 133.18.122.123 | 300 |

**é‡è¦**: DNSå¤‰æ›´æ™‚ã¯TTLã‚’çŸ­ãï¼ˆ300ç§’ï¼‰è¨­å®šã™ã‚‹ã¨ä¼æ’­ãŒæ—©ããªã‚Šã¾ã™ã€‚

### **1-3. SPFãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**

ãƒ¡ãƒ¼ãƒ«é€ä¿¡æ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€TXTãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼š

```
v=spf1 +a +mx +ip4:133.18.122.123 ~all
```

### **1-4. DNSä¼æ’­ã‚’ç¢ºèª**

**ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¢ºèª:**
```bash
dig anke.jp +short
dig www.anke.jp +short
```

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**: `133.18.122.123`

**Googleã®å…¬é–‹DNSã§ç¢ºèª:**
```bash
dig @8.8.8.8 anke.jp +short
dig @8.8.8.8 www.anke.jp +short
```

**ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã§ç¢ºèª:**
- https://www.whatsmydns.net/#A/anke.jp
- ä¸–ç•Œä¸­ã®DNSã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ç¢ºèªã§ãã¾ã™

### **1-5. DNSä¼æ’­æ™‚é–“**

- **TTL 300ç§’ã®å ´åˆ**: 5ã€œ20åˆ†
- **TTL 3600ç§’ã®å ´åˆ**: 1ã€œ2æ™‚é–“
- **æœ€å¤§**: 24ã€œ48æ™‚é–“

**æ³¨æ„**: VPSã‚µãƒ¼ãƒãƒ¼ã®ãƒ­ãƒ¼ã‚«ãƒ«DNSã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå¤ã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚Googleã®å…¬é–‹DNSï¼ˆ8.8.8.8ï¼‰ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚

---

## ã‚¹ãƒ†ãƒƒãƒ—2: Nginxè¨­å®šã®æ›´æ–°

### **2-1. VPSã«SSHæ¥ç¶š**

```bash
ssh -i ~/.ssh/anke-nextjs.key ubuntu@133.18.122.123
```

### **2-2. æ—¢å­˜ã®Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†**

```bash
sudo nano /etc/nginx/sites-available/anke-nextjs
```

`server_name`è¡Œã‚’ä»¥ä¸‹ã«å¤‰æ›´ï¼š

```nginx
server {
    listen 80;
    server_name anke.jp www.anke.jp;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
        
        # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
    
    # Next.jsé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ_nextï¼‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    location /_next/static {
        proxy_pass http://localhost:3000;
        proxy_cache_valid 200 60m;
        add_header Cache-Control "public, max-age=3600, immutable";
    }
    
    # ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    location ~* \.(jpg|jpeg|png|gif|ico|svg|webp)$ {
        proxy_pass http://localhost:3000;
        proxy_cache_valid 200 7d;
        add_header Cache-Control "public, max-age=604800";
    }
}
```

ä¿å­˜ã—ã¦çµ‚äº†ï¼š
- `Ctrl + O` â†’ Enterï¼ˆä¿å­˜ï¼‰
- `Ctrl + X`ï¼ˆçµ‚äº†ï¼‰

### **2-3. ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆ**

```bash
sudo ln -s /etc/nginx/sites-available/anke.jp /etc/nginx/sites-enabled/
```

### **2-3. Nginxè¨­å®šã‚’ãƒ†ã‚¹ãƒˆã—ã¦å†èµ·å‹•**

```bash
# è¨­å®šã‚’ãƒ†ã‚¹ãƒˆ
sudo nginx -t

# Nginxã‚’ãƒªãƒ­ãƒ¼ãƒ‰
sudo systemctl reload nginx
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**
```
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
```

---

## ã‚¹ãƒ†ãƒƒãƒ—3: SSLè¨¼æ˜æ›¸ã®å–å¾—

### **3-1. Certbotã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

```bash
sudo apt update
sudo apt install -y certbot python3-certbot-nginx
```

### **3-2. SSLè¨¼æ˜æ›¸ã‚’å–å¾—**

**é‡è¦**: DNSä¼æ’­ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```bash
# Googleã®å…¬é–‹DNSã§ç¢ºèª
dig @8.8.8.8 anke.jp +short
dig @8.8.8.8 www.anke.jp +short
```

`133.18.122.123`ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸã‚‰ã€SSLè¨¼æ˜æ›¸ã‚’å–å¾—ï¼š

```bash
sudo certbot --nginx -d anke.jp -d www.anke.jp
```

**å¯¾è©±å½¢å¼ã®å…¥åŠ›:**

1. **ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹**: `info@anke.jp`ï¼ˆSSLè¨¼æ˜æ›¸ã®æ›´æ–°é€šçŸ¥ç”¨ï¼‰
2. **åˆ©ç”¨è¦ç´„**: `Y`ï¼ˆåŒæ„ï¼‰
3. **ãƒ¡ãƒ¼ãƒ«é…ä¿¡**: `N`ï¼ˆä¸è¦ãªå ´åˆï¼‰

**æˆåŠŸæ™‚ã®å‡ºåŠ›:**
```
Successfully received certificate.
Certificate is saved at: /etc/letsencrypt/live/anke.jp/fullchain.pem
Key is saved at:         /etc/letsencrypt/live/anke.jp/privkey.pem
This certificate expires on 2026-04-16.
Certbot has set up a scheduled task to automatically renew this certificate in the background.

Deploying certificate
Successfully deployed certificate for anke.jp to /etc/nginx/sites-enabled/anke-nextjs
Successfully deployed certificate for www.anke.jp to /etc/nginx/sites-enabled/anke-nextjs
Congratulations! You have successfully enabled HTTPS on https://anke.jp and https://www.anke.jp
```

**CertbotãŒè‡ªå‹•çš„ã«å®Ÿè¡Œã™ã‚‹å†…å®¹:**
- âœ… SSLè¨¼æ˜æ›¸ã‚’å–å¾—
- âœ… Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«HTTPSè¨­å®šã‚’è¿½åŠ 
- âœ… HTTP â†’ HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’è¨­å®š
- âœ… Nginxã‚’ãƒªãƒ­ãƒ¼ãƒ‰
- âœ… è‡ªå‹•æ›´æ–°ã‚¿ã‚¹ã‚¯ã‚’è¨­å®š

### **3-3. SSLè¨¼æ˜æ›¸ã®ç¢ºèª**

```bash
sudo certbot certificates
```

**å‡ºåŠ›ä¾‹:**
```
Found the following certs:
  Certificate Name: anke.jp
    Domains: anke.jp www.anke.jp
    Expiry Date: 2026-04-16 (VALID: 89 days)
    Certificate Path: /etc/letsencrypt/live/anke.jp/fullchain.pem
    Private Key Path: /etc/letsencrypt/live/anke.jp/privkey.pem
```

### **3-4. è‡ªå‹•æ›´æ–°ã®ç¢ºèª**

Certbotã¯è‡ªå‹•çš„ã«è¨¼æ˜æ›¸ã®æ›´æ–°ã‚¿ã‚¹ã‚¯ã‚’è¨­å®šã—ã¾ã™ï¼š

```bash
# è‡ªå‹•æ›´æ–°ã‚¿ã‚¤ãƒãƒ¼ã®çŠ¶æ…‹ã‚’ç¢ºèª
sudo systemctl status certbot.timer
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**
```
â— certbot.timer - Run certbot twice daily
     Loaded: loaded
     Active: active (waiting)
```

---

## ã‚¹ãƒ†ãƒƒãƒ—4: SSLè‡ªå‹•æ›´æ–°ã®è¨­å®š

### **4-1. è‡ªå‹•æ›´æ–°ã®ãƒ†ã‚¹ãƒˆ**

```bash
sudo certbot renew --dry-run
```

æ­£å¸¸ãªå ´åˆï¼š
```
Congratulations, all simulated renewals succeeded
```

### **4-2. è‡ªå‹•æ›´æ–°CRONã‚¸ãƒ§ãƒ–ã®ç¢ºèª**

Certbotã¯è‡ªå‹•çš„ã«CRONã‚¸ãƒ§ãƒ–ã¾ãŸã¯systemdã‚¿ã‚¤ãƒãƒ¼ã‚’è¨­å®šã—ã¾ã™ã€‚

```bash
# systemdã‚¿ã‚¤ãƒãƒ¼ã‚’ç¢ºèª
systemctl list-timers | grep certbot

# ã¾ãŸã¯ã€CRONã‚¸ãƒ§ãƒ–ã‚’ç¢ºèª
sudo cat /etc/cron.d/certbot
```

### **4-3. æ‰‹å‹•æ›´æ–°ï¼ˆå¿…è¦ãªå ´åˆï¼‰**

```bash
sudo certbot renew
```

SSLè¨¼æ˜æ›¸ã¯90æ—¥é–“æœ‰åŠ¹ã§ã€30æ—¥å‰ã‹ã‚‰è‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™ã€‚

---

## ã‚¹ãƒ†ãƒƒãƒ—4: ç’°å¢ƒå¤‰æ•°ã®æ›´æ–°

### **4-1. VPSã®.env.localã‚’æ›´æ–°**

```bash
cd /var/www/anke-nextjs
nano .env.local
```

ä»¥ä¸‹ã®è¡Œã‚’æ›´æ–°ï¼š

```env
# å¤‰æ›´å‰
NEXT_PUBLIC_APP_URL=http://localhost:3000

# å¤‰æ›´å¾Œ
NEXT_PUBLIC_APP_URL=https://anke.jp
```

ä¿å­˜ã—ã¦çµ‚äº†ï¼š
- `Ctrl + O` â†’ Enterï¼ˆä¿å­˜ï¼‰
- `Ctrl + X`ï¼ˆçµ‚äº†ï¼‰

### **4-2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†èµ·å‹•**

```bash
pm2 restart anke-nextjs
pm2 status
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**
```
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id â”‚ name               â”‚ mode     â”‚ â†º    â”‚ status    â”‚ cpu      â”‚ memory   â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ anke-nextjs        â”‚ fork     â”‚ 7    â”‚ online    â”‚ 0%       â”‚ 150mb    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **5-3. ãƒ­ãƒ¼ã‚«ãƒ«ã®.env.localã‚’æ›´æ–°ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**

ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§ãƒªãƒ¢ãƒ¼ãƒˆAPIã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼š

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œ
open -a "TextEdit" .env.local
```

ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```env
# æœ¬ç•ªç’°å¢ƒURLï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
NEXT_PUBLIC_APP_URL=https://anke.jp
```

---

## ã‚¹ãƒ†ãƒƒãƒ—5: å‹•ä½œç¢ºèª

### **5-1. HTTPSã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¢ºèª**

ãƒ–ãƒ©ã‚¦ã‚¶ã§ä»¥ä¸‹ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ï¼š

```
https://anke.jp
```

âœ… **ç¢ºèªé …ç›®**:
- âœ… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«éµãƒãƒ¼ã‚¯ğŸ”’ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… è¨¼æ˜æ›¸ãŒæœ‰åŠ¹ï¼ˆéµãƒãƒ¼ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç¢ºèªï¼‰
- âœ… ã€Œã“ã®æ¥ç¶šã¯ä¿è­·ã•ã‚Œã¦ã„ã¾ã™ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹

### **5-2. HTTPãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’ç¢ºèª**

ãƒ–ãƒ©ã‚¦ã‚¶ã§ä»¥ä¸‹ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ï¼š

```
http://anke.jp
```

âœ… **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: è‡ªå‹•çš„ã« `https://anke.jp` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹

### **5-3. wwwã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ç¢ºèª**

ãƒ–ãƒ©ã‚¦ã‚¶ã§ä»¥ä¸‹ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ï¼š

```
https://www.anke.jp
http://www.anke.jp
```

âœ… **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**: ä¸¡æ–¹ã¨ã‚‚æ­£å¸¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã€HTTPã¯è‡ªå‹•çš„ã«HTTPSã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹

### **5-4. SSLè¨¼æ˜æ›¸ã®è©³ç´°ã‚’ç¢ºèª**

ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã®éµãƒãƒ¼ã‚¯ğŸ”’ã‚’ã‚¯ãƒªãƒƒã‚¯

âœ… **ç¢ºèªé …ç›®**:
- **ç™ºè¡Œè€…**: Let's Encrypt
- **æœ‰åŠ¹æœŸé™**: 2026å¹´4æœˆ16æ—¥
- **å¯¾è±¡**: anke.jp, www.anke.jp
- **æš—å·åŒ–**: TLS 1.3 ã¾ãŸã¯ TLS 1.2

### **5-5. ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ç¢ºèª**

```bash
# SSLè¨¼æ˜æ›¸ã®ç¢ºèª
curl -I https://anke.jp

# HTTPãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã®ç¢ºèª
curl -I http://anke.jp
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›ï¼ˆHTTPãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼‰:**
```
HTTP/1.1 301 Moved Permanently
Location: https://anke.jp/
```

---

## å®Œäº†

ğŸ‰ **ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼**

ä»¥ä¸‹ãŒå®Œäº†ã—ã¾ã—ãŸï¼š

- âœ… DNSè¨­å®šï¼ˆanke.jp â†’ 133.18.122.123ï¼‰
- âœ… Nginxè¨­å®šï¼ˆãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ï¼‰
- âœ… SSLè¨¼æ˜æ›¸å–å¾—ï¼ˆLet's Encryptï¼‰
- âœ… HTTPSå¯¾å¿œ
- âœ… HTTPâ†’HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
- âœ… è‡ªå‹•æ›´æ–°è¨­å®š
- âœ… ç’°å¢ƒå¤‰æ•°æ›´æ–°

**ã‚¢ã‚¯ã‚»ã‚¹URL:**
- æœ¬ç•ª: https://anke.jp
- ç®¡ç†ç”»é¢: https://anke.jp/admin

**SSLè¨¼æ˜æ›¸:**
- æœ‰åŠ¹æœŸé™: 2026å¹´4æœˆ16æ—¥
- è‡ªå‹•æ›´æ–°: è¨­å®šæ¸ˆã¿ï¼ˆ30æ—¥å‰ã‹ã‚‰è‡ªå‹•æ›´æ–°ï¼‰

---

## ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### SSLè¨¼æ˜æ›¸ã®æ‰‹å‹•æ›´æ–°

```bash
sudo certbot renew
```

### SSLè¨¼æ˜æ›¸ã®ç¢ºèª

```bash
sudo certbot certificates
```

### Nginxè¨­å®šã®ç¢ºèª

```bash
sudo nginx -t
sudo systemctl status nginx
```

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¢ºèª

```bash
pm2 status
pm2 logs anke-nextjs
```
- **ç™ºè¡Œè€…**: Let's Encrypt
- **æœ‰åŠ¹æœŸé™**: ç´„90æ—¥å¾Œ
- **ãƒ‰ãƒ¡ã‚¤ãƒ³**: anke.jp, www.anke.jp

### **6-5. SSLãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã§ç¢ºèª**

https://www.ssllabs.com/ssltest/analyze.html?d=anke.jp

âœ… ã‚°ãƒ¬ãƒ¼ãƒ‰ A ã¾ãŸã¯ A+ ãŒç†æƒ³

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### **ã‚¨ãƒ©ãƒ¼: DNS_PROBE_FINISHED_NXDOMAIN**

**åŸå› **: DNSãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯DNSä¼æ’­ãŒå®Œäº†ã—ã¦ã„ãªã„

**å¯¾å‡¦æ³•**:
1. DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
2. DNSä¼æ’­ã‚’å¾…ã¤ï¼ˆæœ€å¤§48æ™‚é–“ï¼‰
3. `dig anke.jp`ã§DNSã‚’ç¢ºèª

---

### **ã‚¨ãƒ©ãƒ¼: 502 Bad Gateway**

**åŸå› **: Next.jsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¦ã„ãªã„

**å¯¾å‡¦æ³•**:
```bash
# PM2ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª
pm2 status

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†èµ·å‹•
pm2 restart anke-nextjs

# ãƒ­ã‚°ã‚’ç¢ºèª
pm2 logs anke-nextjs
```

---

### **ã‚¨ãƒ©ãƒ¼: SSLè¨¼æ˜æ›¸ã®å–å¾—ã«å¤±æ•—**

**åŸå› **: ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒVPSã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«è§£æ±ºã•ã‚Œã¦ã„ãªã„

**å¯¾å‡¦æ³•**:
1. DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª
2. `dig anke.jp`ã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèª
3. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã§ãƒãƒ¼ãƒˆ80ã¨443ãŒé–‹ã„ã¦ã„ã‚‹ã‹ç¢ºèª

```bash
# ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ç¢ºèª
sudo ufw status

# ãƒãƒ¼ãƒˆ80ã¨443ã‚’é–‹ã
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
```

---

### **ã‚¨ãƒ©ãƒ¼: Mixed Contentï¼ˆæ··åœ¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼‰**

**åŸå› **: HTTPSãƒšãƒ¼ã‚¸å†…ã§HTTPãƒªã‚½ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã‚‹

**å¯¾å‡¦æ³•**:
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
2. ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’HTTPSã«å¤‰æ›´
3. ç’°å¢ƒå¤‰æ•°`NEXT_PUBLIC_APP_URL`ãŒæ­£ã—ã„ã‹ç¢ºèª

---

### **Nginxè¨­å®šã®ç¢ºèª**

```bash
# Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
sudo cat /etc/nginx/sites-available/anke.jp

# Nginxè¨­å®šã‚’ãƒ†ã‚¹ãƒˆ
sudo nginx -t

# Nginxã‚’ãƒªãƒ­ãƒ¼ãƒ‰
sudo systemctl reload nginx

# Nginxã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª
systemctl status nginx

# Nginxã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª
sudo tail -50 /var/log/nginx/anke.jp.error.log
```

---

## æœ€çµ‚çš„ãªã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼
  â†“
  https://anke.jp (HTTPSã€ãƒãƒ¼ãƒˆ443)
  â†“
  Nginx (ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·)
  â”œâ”€ SSL/TLSçµ‚ç«¯ï¼ˆLet's Encryptè¨¼æ˜æ›¸ï¼‰
  â”œâ”€ HTTPãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼ˆHTTP â†’ HTTPSï¼‰
  â””â”€ é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  â†“
  Next.js (PM2ã§èµ·å‹•ã€ãƒãƒ¼ãƒˆ3000)
  â†“
  Supabase (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)
```

---

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### **Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**
```
/etc/nginx/
â”œâ”€â”€ nginx.conf                      # ãƒ¡ã‚¤ãƒ³è¨­å®š
â”œâ”€â”€ sites-available/
â”‚   â”œâ”€â”€ default                     # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šï¼ˆç„¡åŠ¹åŒ–æ¨å¥¨ï¼‰
â”‚   â””â”€â”€ anke.jp                     # anke.jpè¨­å®š â˜…
â””â”€â”€ sites-enabled/
    â””â”€â”€ anke.jp -> ../sites-available/anke.jp  # ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯
```

### **SSLè¨¼æ˜æ›¸**
```
/etc/letsencrypt/
â”œâ”€â”€ live/
â”‚   â””â”€â”€ anke.jp/
â”‚       â”œâ”€â”€ fullchain.pem           # è¨¼æ˜æ›¸ãƒã‚§ãƒ¼ãƒ³
â”‚       â”œâ”€â”€ privkey.pem             # ç§˜å¯†éµ
â”‚       â”œâ”€â”€ cert.pem                # è¨¼æ˜æ›¸
â”‚       â””â”€â”€ chain.pem               # ä¸­é–“è¨¼æ˜æ›¸
â””â”€â”€ renewal/
    â””â”€â”€ anke.jp.conf                # è‡ªå‹•æ›´æ–°è¨­å®š
```

### **ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«**
```
/var/log/nginx/
â”œâ”€â”€ anke.jp.access.log              # ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°
â””â”€â”€ anke.jp.error.log               # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
```

---

## ğŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ãƒ‰ãƒ¡ã‚¤ãƒ³ç§»è¡Œã¨SSLå°å…¥ã®ç¢ºèªäº‹é …ï¼š

### **ãƒ•ã‚§ãƒ¼ã‚º1: DNSè¨­å®š**
- [ ] ç¾åœ¨ã®DNSè¨­å®šã‚’ç¢ºèªï¼ˆ133.18.234.69 â†’ 133.18.122.123ã¸ã®å¤‰æ›´ãŒå¿…è¦ï¼‰
- [ ] DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆA: anke.jp â†’ 133.18.122.123ï¼‰
- [ ] DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆA: www.anke.jp â†’ 133.18.122.123ï¼‰
- [ ] SPFãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡ã™ã‚‹å ´åˆï¼‰
- [ ] DNSä¼æ’­ã‚’ç¢ºèªï¼ˆ`dig anke.jp`ã§133.18.122.123ãŒè¿”ã•ã‚Œã‚‹ï¼‰
- [ ] ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã§ç¢ºèªï¼ˆwhatsmydns.netï¼‰

### **ãƒ•ã‚§ãƒ¼ã‚º2: Nginxè¨­å®š**
- [ ] Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆ`/etc/nginx/sites-available/anke.jp`ï¼‰
- [ ] ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’ä½œæˆ
- [ ] Nginxè¨­å®šã‚’ãƒ†ã‚¹ãƒˆï¼ˆ`sudo nginx -t`ï¼‰
- [ ] Nginxã‚’ãƒªãƒ­ãƒ¼ãƒ‰
- [ ] Certbotã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] SSLè¨¼æ˜æ›¸ã‚’å–å¾—ï¼ˆ`sudo certbot --nginx`ï¼‰
- [ ] SSLè¨¼æ˜æ›¸ã‚’ç¢ºèªï¼ˆ`sudo certbot certificates`ï¼‰
- [ ] è‡ªå‹•æ›´æ–°ã‚’ãƒ†ã‚¹ãƒˆï¼ˆ`sudo certbot renew --dry-run`ï¼‰
- [ ] VPSã®.env.localã‚’æ›´æ–°ï¼ˆ`NEXT_PUBLIC_APP_URL=https://anke.jp`ï¼‰
- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†èµ·å‹•
- [ ] HTTPSã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¢ºèªï¼ˆhttps://anke.jpï¼‰
- [ ] HTTPãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’ç¢ºèªï¼ˆhttp://anke.jp â†’ https://anke.jpï¼‰
- [ ] SSLè¨¼æ˜æ›¸ã‚’ç¢ºèªï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®éµãƒãƒ¼ã‚¯ï¼‰
- [ ] SSLãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼ˆSSL Labsï¼‰

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### **1. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¿½åŠ **

`/etc/nginx/sites-available/anke.jp`ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```nginx
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;
```

### **2. SSLè¨­å®šã®å¼·åŒ–**

CertbotãŒè‡ªå‹•çš„ã«è¿½åŠ ã™ã‚‹SSLè¨­å®šã‚’ç¢ºèªï¼š

```bash
sudo cat /etc/nginx/sites-available/anke.jp | grep ssl_
```

---

## å‚è€ƒè³‡æ–™

- [Let's Encryptå…¬å¼ã‚µã‚¤ãƒˆ](https://letsencrypt.org/)
- [Certbotå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://certbot.eff.org/)
- [Nginxå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://nginx.org/en/docs/)
- [SSL Labs SSL Test](https://www.ssllabs.com/ssltest/)
- [Next.js Deployment](https://nextjs.org/docs/deployment)
